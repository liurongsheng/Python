# 持久化-文件

## 文件
  - 长久保存信息的一种数据信息集合
  - 常用操作
    - 打开关闭（文件一旦打开，需要关闭操作）
    - 读写内容
    - 查找

### open 函数负责打开文件，带有很多参数
  - 第一个参数： 必须有，文件的路径和名称
  - mode：表明文件用什么方式打开
    - r:以只读方式打开
    - w：写方式打开，会覆盖以前的内容
    - x：创建方式打开，如文件已经存在，报错
    - a：append方式，以追加的方式对文件内容进行写入
    - b：binary方式，二进制方式写入
    - t：文本方式打开
    - +：可读写

```python
# 打开文件，用写的方式
# r表示后面字符串内容不需要转义
# f称之为文件句柄
f = open(r"test.txt", 'w')
# 文件打开后必须关闭
f.close()
```
### with语句
with语句使用的技术是一种成为上下文管理协议的技术(ContextManagementProtocal)

自动判断文件的 作用域， 自动关闭不在使用的打开的文件句柄
```python
with open(r"test.txt", 'r') as f:
  pass
  # 下面语句块开始对文件f进行操作
  # 在本模块中不需要在使用close关闭文件f
```

### seek（offset， from)
  - 移动文件的读取位置，也叫读取指针
  - from的取值范围：
    - 0： 从文件头开始偏移
    - 1：从文件当前位置开始偏移
    - 2： 从文件末尾开始偏移
  - 移动的单位是字节(byte)
  - 一个汉子由若干个字节构成
  - 返回文件只针对 当前位置

### 文件的写操作-write
  - write(str): 把字符串写入文件
  - writeline(str): 把字符串按行写入文件
  - 区别
    - write函数参数只能是字符串
    - writerline参数可以是字符串，也可以是字符序列
    
### 持久化 - pickle
  - 序列化（持久化，落地）：把程序运行中的信息保存在磁盘上
  - 反序列化： 序列号的逆过程
  - pickle： python提供的序列化模块
  - pickle.dump:序列化
  - pickle.load:反序列化

### 持久化-shelve
  - 持久化工具
  - 类似字典，用kv对保存数据，存取方式跟字典也类似
  - open, close

### shelve特性
  - 不支持多个应用并行写入
    - 为了解决这个问题，open的时候可以使用flag=r
  - 写回问题
    - shelv恶魔人情况下不会等待持久化对象进行任何修改
    - 解决方法： 强制写回：writeback=True
